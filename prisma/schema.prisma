generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       Int     @id @default(autoincrement())
  email    String  @unique
  username String  @unique
  password String
  houses   House[]
}

model House {
  id       Int       @id @default(autoincrement())
  userId   Int
  name     String
  address  String?
  user     User      @relation(fields: [userId], references: [id])
  storages Storage[]
}

model Storage {
  id      Int      @id @default(autoincrement())
  houseId Int
  name    String?
  type    Category
  stocks  Stock[]
  house   House    @relation(fields: [houseId], references: [id])
}

model Ingredient {
  id     Int     @id @default(autoincrement())
  name   String
  price  Int?
  stocks Stock[]
}

model Stock {
  id           Int         @id @default(autoincrement())
  ingredientId Int?
  storageId    Int
  custom_name  String?
  quantity     Float
  unit         Unit
  last_updated DateTime    @default(now()) @updatedAt
  status       Status      @default(GOOD)
  category     Category
  ingredient   Ingredient? @relation(fields: [ingredientId], references: [id])
  storage      Storage     @relation(fields: [storageId], references: [id])

  @@unique([ingredientId, storageId])
  @@unique([custom_name, storageId])
}

enum Unit {
  OUNCE
  POUND
  GRAM
  KILOGRAM
  MILILITER
  LITER
  FLUID_OUNCE
  CUP
  PINT
  QUART
  GALLON
  TEASPOON
  TABLESPOON
  BAG
  CAN
  BOTTLE
  BOX
  PIECE
  SACK
  LOAVES
  BUNDLES
  PACKAGE
}

enum Status {
  GOOD
  LOW_STOCK
  OUT_OF_STOCK
  EXPIRED
}

enum Category {
  FRIDGE
  PANTRY
  FREEZER
  SPICE_RACK
  OTHER
}
